<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.nextit.team1.mappers.UserInfoMapper">
    <select id="userInfoSelect" resultType="UserInfoDTO">
        SELECT
            EMP_CODE, EMP_NAME, EMP_PASS, DEP_CODE, POS_CODE, PHONE_NUM, EXT_NUM, EMP_MAIL, COR_CODE, EMP_RRN
        FROM
            EMPLOYEE
        WHERE
            EMP_CODE = #{empCode}
    </select>

    <update id="userInfoUpdate" parameterType="UserInfoDTO">
        UPDATE
            EMPLOYEE
        SET
            EMP_NAME = #{empName},
            EMP_PASS = #{empPass},
            DEP_CODE = #{depCode},
            POS_CODE = #{posCode},
            PHONE_NUM = #{phoneNum},
            EXT_NUM = #{extNum},
            EMP_MAIL = #{empMail},
            COR_CODE = #{corCode}
        WHERE
            EMP_CODE = #{empCode}
    </update>

    <!-- 상관에게 수정 요청 전송 -->
      <update id="modifyReqUpdate" parameterType="UserInfoDTO">
        UPDATE
            EMPLOYEE
        SET
            MODIFY_REQ = #{modifyReq}
        WHERE
            EMP_CODE = #{corCode}
    </update>

    <select id="getModifyReq" parameterType="String" resultType="String">
        SELECT
            MODIFY_REQ
        FROM
            EMPLOYEE
        WHERE
            EMP_CODE = #{corCode}
    </select>

    <select id="getPosCode" resultType="String">
        SELECT DISTINCT
            c.POS_CODE
        FROM
            EMPLOYEE e, CODE c
        WHERE
            SUBSTRING_INDEX(e.EMP_CODE,'-',1) = c.COM_CODE
    </select>
</mapper>